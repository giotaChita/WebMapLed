<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="initial-scale=1,user-scalable=no,maximum-scale=1,width=device-width">
        <meta name="mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <link rel="stylesheet" href="./resources/ol.css">
        <link rel="stylesheet" href="resources/fontawesome-all.min.css">
        <link rel="stylesheet" href="./resources/ol-layerswitcher.css">
        <link rel="stylesheet" href="./resources/qgis2web.css">
<style>
.search-layer {
  top: 135px;
  left: .5em;
}
.ol-touch .search-layer {
  top: 180px;
}
</style>
        <style>
        html, body {
            background-color: #ffffff;
        }
        .ol-control button {
            background-color: #f8f8f8 !important;
            color: #000000 !important;
            border-radius: 0px !important;
        }
        .ol-zoom, .geolocate, .gcd-gl-control .ol-control {
            background-color: rgba(255,255,255,.4) !important;
            padding: 3px !important;
        }
        .ol-scale-line {
            background: none !important;
        }
        .ol-scale-line-inner {
            border: 2px solid #f8f8f8 !important;
            border-top: none !important;
            background: rgba(255, 255, 255, 0.5) !important;
            color: black !important;
        }

        .hover-coordinates {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.7);
            padding: 5px;
            border: 1px solid #ccc;
            border-radius: 3px;
        }
        </style>

        <style>
        .geolocate {
            top: 65px;
            left: .5em;
        }
        .ol-touch .geolocate {
            top: 80px;
        }
        </style>
<style>
.tooltip {
  position: relative;
  background: rgba(0, 0, 0, 0.5);
  border-radius: 4px;
  color: white;
  padding: 4px 8px;
  opacity: 0.7;
  white-space: nowrap;
}
.tooltip-measure {
  opacity: 1;
  font-weight: bold;
}
.tooltip-static {
  background-color: #ffcc33;
  color: black;
  border: 1px solid white;
}
.tooltip-measure:before,
.tooltip-static:before {
  border-top: 6px solid rgba(0, 0, 0, 0.5);
  border-right: 6px solid transparent;
  border-left: 6px solid transparent;
  content: "";
  position: absolute;
  bottom: -6px;
  margin-left: -7px;
  left: 50%;
}
.tooltip-static:before {
  border-top-color: #ffcc33;
}
.measure-control {
  top: 100px;
  left: .5em;
  display: flex;
}
.ol-touch .measure-control {
  top: 130px;
}
.measure-control label {
  padding: 1px;
  padding-right: 4px;
}
</style>
        <style>
        html, body, #map {
            width: 100%;
            height: 100%;
            padding: 0;
            margin: 0;
        }
        </style>
        <title></title>
    </head>
    <body>
      <div id="map">
        <div id="popup" class="ol-popup">
            <a href="#" id="popup-closer" class="ol-popup-closer"></a>
            <div id="popup-content"></div>
            <div id="coordinates" class="popup-coordinates"></div> <!-- Add this div for displaying coordinates -->
        </div>
    </div>
    <!-- Hover coordinates element -->
    <div id="hover-coordinates" class="hover-coordinates"></div>
     <!-- Add Marker button -->
    <div id="markerButton" class="ol-unselectable ol-control custom-control">
      <button id="addMarkerButton" class="custom-button">
          <img src="resources/led_icon.png" alt="Add Marker">
      </button>
  </div>
  

    <script src="resources/qgis2web_expressions.js"></script>
    <script src="resources/polyfills.js"></script>
    <script src="./resources/functions.js"></script>
    <script src="./resources/ol.js"></script>
    <script src="./resources/ol-layerswitcher.js"></script>
    <script src="layers/TestFile_1.js"></script>
    <script src="styles/TestFile_1_style.js"></script>
    <script src="./layers/layers.js" type="text/javascript"></script> 
    <script src="./resources/Autolinker.min.js"></script>
    <script src="./resources/qgis2web.js"></script>
   <!-- <script src="./resources/ButtonMarker.js"></script> -->
    <script src="./resources/addMarker.js"></script>
        <!-- Script to load Google API client and initialize it -->
        <script>
          // Load the Google API client library
          gapi.load('client', initClient);
  
          // Initialize the Google API client
          function initClient() {
              gapi.client.init({
                  apiKey: 'YOUR_API_KEY',
                  clientId: 'YOUR_CLIENT_ID',
                  discoveryDocs: ['https://sheets.googleapis.com/$discovery/rest'],
                  scope: 'https://www.googleapis.com/auth/spreadsheets'
              }).then(function() {
                  // Google API client is initialized, you can now make API requests
                  // For example, you can make a request to read data from a Google Sheet
                  gapi.client.sheets.spreadsheets.values.get({
                      spreadsheetId: 'YOUR_SPREADSHEET_ID',
                      range: 'Sheet1!A1:B2'
                  }).then(function(response) {
                      console.log('Data from Google Sheet:', response.result);
                  }, function(error) {
                      console.error('Error reading data from Google Sheet:', error);
                  });
              });
          }
  
          // Function to handle authentication with Google
          function authenticate() {
              gapi.auth2.getAuthInstance().signIn();
          }
      </script>
    <script>
      // Define the function to fetch marker information from Google Sheets
      async function fetchMarkerInfoFromSheets() {
          try {
              // Authenticate with Google
              await gapi.auth2.getAuthInstance().signIn();
  
              // Make a request to read data from your spreadsheet
              const response = await gapi.client.sheets.spreadsheets.values.get({
                  spreadsheetId: 'https://docs.google.com/spreadsheets/d/12r7tEhlRnmSy1g2lmRtvzTIjnt8ojouwfhrtyGNhO7U/edit?usp=sharing',
                  range: 'Sheet1!B2:I' // Adjust the range to match the columns where your marker information is located
              });
  
              // Parse the response and return marker information as an array of objects
              const markerInfoArray = response.result.values.map(row => ({
                  id: row[0], //  ID is in column B
                  latitude: parseFloat(row[1]), //  latitude is in column C
                  longitude: parseFloat(row[2]), //  longitude is in column D
                  netType: row[3], //  Net Type is in column E
                  pillarType: row[4], //  Pillar Type is in column F
                  luminairType: row[5], //  Luminair Type is in column G
                  pillarHeight: parseFloat(row[6]), //  Pillar's Height is in column H
                  luminaireHeight: parseFloat(row[7]) //  Luminaire Height is in column I
              }));
  
              return markerInfoArray;
          } catch (error) {
              console.error('Error fetching marker information from Google Sheets:', error);
              return [];
          }
      }
  
      // Call this function to fetch marker information when needed
      async function addMarkersFromGoogleSheets() {
          const markerInfo = await fetchMarkerInfoFromSheets();
          // Call a function to add markers to your map using the fetched marker information
          addMarkersToMap(markerInfo);
      }
  </script>
    <script>
      var hoverCoordinates = document.getElementById('hover-coordinates');
      map.on('pointermove', function(event) {
        var coord = ol.proj.toLonLat(event.coordinate);
        hoverCoordinates.innerHTML = 'Longitude: ' + coord[0].toFixed(4) + '<br>Latitude: ' + coord[1].toFixed(4);
        // hoverCoordinates.style.left = event.pixel[0] + 'px';
        // hoverCoordinates.style.top = event.pixel[1] - 15 + 'px';
        hoverCoordinates.style.left = '10px'; // Set the left position to 10px
        hoverCoordinates.style.bottom = '10px'; 
        hoverCoordinates.style.display = 'block';
        });

        map.on('pointerleave', function() {
          hoverCoordinates.style.display = 'none';
          });
      </script>
      <script src="excelMarker.js"></script>
    </body>
</html>
